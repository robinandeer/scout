<div class="panel header-footer__wrapper--overlay family-panel">

  <div class="header--overlay column__wrapper family-header">
    <div class="column center-center">
      <span class="family-id">Family {{family.id}}</span>
    </div>
    <div class="column center-center medium">
      Last update: {{fromNow family.updateDate}}
    </div>
    <div class="column center-center medium">
      <div class="btn-group">
        <div class="btn">
          <div class="btn__body regular--stretched">
            {{#link-to "variants" family}}Variants{{/link-to}}
          </div>
        </div>

        <div {{action "toggleProperty" "isShowingRawPedigree"}} class="btn">
          <div class="btn__body regular--stretched">
            {{#unless isShowingRawPedigree}}
            Edit pedigree
            {{else}}
            Save pedigree
            {{/unless}}
          </div>
        </div>
      </div>{{! END btn-group }}
    </div>{{! END column }}
  </div>{{! END header--overlay }}

  <div class="header-footer__body family-body">
    {{#if isShowingRawPedigree}}
    <div class="raw-pedigree">
      {{{family.pedigree}}}
    </div>

    {{else}}
    <div class="bar--center pedigree-table regular-width mb">
      <table class="table--auto small">
        <thead>
          <tr>
            <th class="slim">IDN</th>
            <th class="slim">CMMS ID</th>
            <th class="slim">SciLife ID</th>
            <th class="slim">CMMS SeqID</th>

            <th class="slim">Sex</th>
            <th class="slim">Phenotype</th>
            <th class="slim">Clinical DB</th>
            <th class="slim">Phenotype terms</th>
            <th class="slim">Inheritance model(s)</th>

            <th class="slim">MD</th>
            <th class="slim">Iso. kit</th>
            <th class="slim">Iso. personell</th>
            <th class="slim">Iso. date</th>
            <th class="slim">Cap. kit</th>
            <th class="slim">Cap. personell</th>
            <th class="slim">Cap. date</th>
            <th class="slim">Cluster. date</th>
            <th class="slim">Seq. kit</th>
          </tr>
        </thead>
        <tbody>
          {{#each sample in family.samples}}
          <tr>
            <td class="slim">{{sample.idn}}</td>
            <td class="slim">{{sample.cmmsid}}</td>
            <td class="slim">{{sample.scilifeid}}</td>
            <td class="slim">{{sample.cmms_seqid}}</td>

            <td class="slim">{{sample.sex}}</td>
            <td class="slim">{{sample.phenotype}}</td>
            <td class="slim">{{sample.clinical_db}}</td>
            <td class="slim">{{sample.phenotype_terms}}</td>
            <td class="slim bar--vertical">
              <div>{{sample.inheritance_model}}</div>
            </td>

            <td class="slim">{{sample.medical_doctor}}</td>
            <td class="slim">{{sample.isolation_kit}}</td>
            <td class="slim">{{sample.isolation_personnel}}</td>
            <td class="slim">{{sample.isolation_date}}</td>
            <td class="slim">{{sample.capture_kit}}</td>
            <td class="slim">{{sample.capture_personnel}}</td>
            <td class="slim">{{sample.capture_date}}</td>
            <td class="slim">{{sample.clustering_date}}</td>
            <td class="slim">{{sample.sequencing_kit}}</td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>{{! END box, family }}

    {{#if hasGeneModels}}
    <div class="bar--center mb">
      <table class="table small regular-width">
        <tbody>
          <tr>
            <th class="regular--stretched">Possible gene models</th>
            {{#each model in family.samples.1.inheritanceModels}}
              <td class="regular--stretched">{{model}}</td>
            {{/each}}
          </tr>
        </tbody>
      </table>
    </div>
    {{/if}}

    <div class="panel__wrapper regular-width family-comments-panel">
      <div class="panel">
        <div class="header-footer__wrapper">
          <div class="header medium slim">Diagnostic comments</div>
          <div class="header-footer__body">
            <div class="list--vertical">
            {{#each comment in diagnosticComments}}
              {{#unless comment.isDestroyed}}
              <div class="comment-box__wrapper family-comment">
                <div class="comment-box">
                  <div class="comment-box__header bar--space-between slim--stretched small">
                    <div><b>{{comment.email}}</b> {{fromNow comment.createdAt}}</div>
                    <div {{action "deleteComment" comment}}>Delete</div>
                  </div>
                  <div class="comment-box__body slim medium">{{comment.body}}</div>
                </div>
              </div>
              {{/unless}}
            {{else}}
              <div class="center-center mt">
                <small>No comments added yet.</small>
              </div>
            {{/each}}
            </div>
          </div>
        </div>{{! END header-footer__wrapper }}
      </div>{{! END panel }}

      <div class="panel">
        <div class="header-footer__wrapper">
          <div class="header medium slim">Research comments</div>
          <div class="header-footer__body">
            <div class="list--vertical">
            {{#each comment in researchComments}}
              <div class="comment-box__wrapper family-comment">
                <div class="comment-box">
                  <div class="comment-box__header bar--space-between slim--stretched small">
                    <div>
                      <b>{{comment.email}}</b> {{fromNow comment.createdAt}}
                    </div>
                    <div {{action "deleteComment" comment}}>Delete</div>
                  </div>
                  <div class="comment-box__body slim medium">{{comment.body}}</div>
                </div>
              </div>
            {{else}}
              <div class="center-center mt">
                <small>No comments added yet.</small>
              </div>
            {{/each}}
            </div>
          </div>
        </div>{{! END header-footer__wrapper }}
      </div>{{! End panel }}
    </div>{{! End box panel__wrapper }}

    <div class="panel__wrapper regular-width family-submit-panel">

      <div class="panel">
        {{comment-box submit="postComment" tags=commentCategories
                      type="IEM" title="IEM Comment"}}
      </div>{{! End panel }}

      <div class="panel">
        {{comment-box submit="postComment" tags=commentCategories
                      type="research" title="Research Comment"}}
      </div>{{! End panel }}

    </div>{{! End box panel__wrapper }}
    {{/if}}
  </div>
</div>
